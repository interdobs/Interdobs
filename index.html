<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Nederlandse BI Podcast</title>
  <!-- Google Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-color: #f0f2f5;
      --text-color: #222;
      --card-bg: #fff;
      --card-shadow: rgba(0, 0, 0, 0.05);
      --primary: #1DA1F2;
      --accent: #ff6b6b;
    }
    [data-theme="dark"] {
      --bg-color: #121212;
      --text-color: #eee;
      --card-bg: #1e1e1e;
      --card-shadow: rgba(0, 0, 0, 0.5);
    }
    *, *::before, *::after { box-sizing: border-box; }
    body {
      margin: 0;
      padding: 0;
      font-family: 'Inter', sans-serif;
      background: var(--bg-color);
      color: var(--text-color);
      line-height: 1.6;
    }
    header {
      background: linear-gradient(135deg, var(--primary), var(--accent));
      color: white;
      padding: 2rem 1rem;
      text-align: center;
      position: sticky;
      top: 0;
      z-index: 10;
      box-shadow: 0 4px 10px var(--card-shadow);
    }
    header h1 { margin: 0; font-size: 2rem; font-weight: 700; }
    header p { margin: 0.5rem 0 0; font-size: 1rem; opacity: 0.9; }
    .theme-toggle {
      position: absolute;
      top:1rem; right:1rem;
      background:rgba(255,255,255,0.2);
      border:none; border-radius:50%;
      width:2.5rem; height:2.5rem;
      display:flex; align-items:center; justify-content:center;
      font-size:1.2rem; color:white;
      cursor:pointer; transition:transform 0.2s ease;
    }
    .theme-toggle:hover { transform: scale(1.1); }
    #google_translate_element { position: absolute; top:1rem; left:1rem; }
    main {
      max-width:960px;
      margin:2rem auto;
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(300px,1fr));
      gap:2rem;
      padding:0 1rem;
    }
    .episode {
      background:var(--card-bg);
      border-radius:12px;
      box-shadow:0 2px 12px var(--card-shadow);
      overflow:hidden;
      display:flex;
      flex-direction:column;
      transition:transform 0.3s ease, box-shadow 0.3s ease;
    }
    .episode:hover {
      transform:translateY(-5px);
      box-shadow:0 6px 20px var(--card-shadow);
    }
    .episode-content { padding:1.5rem; flex-grow:1; }
    .episode-link {
      text-decoration:none;
      color:var(--primary);
      transition:color 0.2s ease;
    }
    .episode-link:hover { color:var(--accent); }
    .episode h2 { margin:0 0 0.5rem; font-size:1.3rem; font-weight:600; }
    .episode meta {
      display:block;
      font-size:0.85rem;
      color:var(--text-color);
      opacity:0.7;
      margin-bottom:1rem;
    }
    .snippet {
      font-size:0.95rem;
      color:var(--text-color);
      opacity:0.85;
      margin-bottom:1rem;
    }
    .episode audio {
      width:100%;
      border-top:1px solid var(--card-shadow);
    }
    .error { color:var(--accent); text-align:center; }
    #load-more {
      display: block;
      margin: 2rem auto;
      padding: 0.75rem 1.5rem;
      font-size: 1rem;
      background: var(--primary);
      color: #fff;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.2s ease;
    }
    #load-more:hover {
      background: var(--accent);
    }
  </style>
</head>
<body>
  <header>
    <script>
      // Auto-translate Dutch→English via Google Translate widget
      document.cookie = "googtrans=/nl/en;path=/";
      document.cookie = "googtrans=/nl/en;domain=" + location.hostname + ";path=/";
    </script>
    <div id="google_translate_element"></div>
    <h1>Dutch BI Podcast</h1>
    <p>Insights and conversations in SAP Business Intelligence</p>
    <button class="theme-toggle" id="toggle-theme">🌙</button>
  </header>

  <main id="episodes">
    <p class="loading">Loading episodes…</p>
  </main>
  <button id="load-more" style="display:none;">Load more</button>

  <script>
    function googleTranslateElementInit() {
      new google.translate.TranslateElement({
        pageLanguage: 'nl',
        includedLanguages: 'en',
        autoDisplay: false,
        multilanguagePage: true
      }, 'google_translate_element');
      setTimeout(() => {
        const combo = document.querySelector('.goog-te-combo');
        if (combo) {
          combo.value = 'en';
          combo.dispatchEvent(new Event('change'));
        }
      }, 500);
    }
  </script>
  <script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

  <script>
    // Dark mode toggle
    const toggle = document.getElementById('toggle-theme');
    const root = document.documentElement;
    function updateTheme() {
      if (localStorage.theme === 'dark' ||
         (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        root.setAttribute('data-theme', 'dark');
        toggle.textContent = '☀️';
      } else {
        root.removeAttribute('data-theme');
        toggle.textContent = '🌙';
      }
    }
    toggle.addEventListener('click', () => {
      localStorage.theme = localStorage.theme === 'dark' ? 'light' : 'dark';
      updateTheme();
    });
    updateTheme();

    // Load episodes in batches with "Load more" button
    const EPISODES_PER_BATCH = 5;
    let allItems = [];
    let currentIndex = 0;

    async function loadFeed() {
      const url = 'https://feed.podbean.com/nederlandsebipodcast/feed.xml';
      try {
        const res = await fetch(url);
        if (!res.ok) throw new Error(`${res.status} ${res.statusText}`);
        const xmlText = await res.text();
        const parser = new DOMParser();
        const xml = parser.parseFromString(xmlText, 'application/xml');
        allItems = Array.from(xml.querySelectorAll('item'));
        document.querySelector('.loading')?.remove();
        renderNextBatch();
      } catch (err) {
        document.getElementById('episodes').innerHTML =
          `<p class="error">Unable to load feed: ${err.message}</p>`;
      }
    }

    function renderNextBatch() {
      const container = document.getElementById('episodes');
      const batch = allItems.slice(currentIndex, currentIndex + EPISODES_PER_BATCH);
      batch.forEach(item => {
        const title      = item.querySelector('title')?.textContent || 'No title';
        const link       = item.querySelector('link')?.textContent || '#';
        const pubDateRaw = item.querySelector('pubDate')?.textContent || '';
        const pubDate    = pubDateRaw
                            ? new Date(pubDateRaw).toISOString().split('T')[0]
                            : '';
        const desc       = item.querySelector('description')?.textContent || '';
        const enclosure  = item.querySelector('enclosure');
        const audioUrl   = enclosure ? enclosure.getAttribute('url') : '';

        const card = document.createElement('article');
        card.className = 'episode';
        card.innerHTML = `
          <div class="episode-content">
            <h2>
              <a href="${link}" target="_blank" class="episode-link">
                ${title}
              </a>
            </h2>
            <meta>${pubDate}</meta>
            <p class="snippet">${desc}</p>
          </div>
          ${audioUrl
            ? `<audio controls src="${audioUrl}"></audio>`
            : ''}
        `;
        container.appendChild(card);
      });

      currentIndex += batch.length;
      const loadMoreBtn = document.getElementById('load-more');
      if (currentIndex < allItems.length) {
        loadMoreBtn.style.display = 'block';
      } else {
        loadMoreBtn.style.display = 'none';
      }
    }

    document.getElementById('load-more').addEventListener('click', renderNextBatch);

    // kick things off
    loadFeed();
  </script>
</body>
</h
